<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Accounts | ZKSync</title>
    <meta name="description" content="">
    <meta name="generator" content="VuePress 1.4.0">
    
    
    <link rel="preload" href="/assets/css/0.styles.edc3c593.css" as="style"><link rel="preload" href="/assets/js/app.b82d5895.js" as="script"><link rel="preload" href="/assets/js/2.565b9e27.js" as="script"><link rel="preload" href="/assets/js/6.6f653a50.js" as="script"><link rel="prefetch" href="/assets/js/10.dd931806.js"><link rel="prefetch" href="/assets/js/11.7423a236.js"><link rel="prefetch" href="/assets/js/12.f5319ed0.js"><link rel="prefetch" href="/assets/js/13.adb2f5e8.js"><link rel="prefetch" href="/assets/js/3.239368e3.js"><link rel="prefetch" href="/assets/js/4.7a4d83b2.js"><link rel="prefetch" href="/assets/js/5.0efc472e.js"><link rel="prefetch" href="/assets/js/7.f6071cf0.js"><link rel="prefetch" href="/assets/js/8.5a1fb425.js"><link rel="prefetch" href="/assets/js/9.f4cc47b4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.edc3c593.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">ZKSync</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/matter-labs/zksync/tree/master/js/zksync.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/matter-labs/zksync/tree/master/js/zksync.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/overview.html" class="sidebar-link">Overview</a></li><li><a href="/getting-started.html" class="sidebar-link">Getting started</a></li><li><a href="/tutorial.html" class="sidebar-link">Tutorial</a></li><li><a href="/providers.html" class="sidebar-link">Providers</a></li><li><a href="/accounts.html" class="active sidebar-link">Accounts</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/accounts.html#wallet" class="sidebar-link">Wallet</a></li><li class="sidebar-sub-header"><a href="/accounts.html#signer" class="sidebar-link">Signer</a></li></ul></li><li><a href="/utils.html" class="sidebar-link">Utils</a></li><li><a href="/types.html" class="sidebar-link">Types</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="accounts"><a href="#accounts" class="header-anchor">#</a> Accounts</h1> <h2 id="wallet"><a href="#wallet" class="header-anchor">#</a> Wallet</h2> <p><code>Wallet</code> object is used to interact with the ZK Sync network. The wallet has an ethereum address associated with it and user that owns this ethereum account owns a corresponding ZK Sync account.
By ownership of ethereum account we mean ability to send ethereum transactions and optionally ability to sign messages.</p> <p>To create transactions in the ZK Sync network wallet must have ZK Sync key pair associated with it. ZK Sync keys are handled by
<a href="#signer">Signer</a> object and can be created using different methods, the most convenient way is to create these keys by deriving them from ethereum signature
of the specific message, this method is used by default if user does not provide <code>Signer</code> created using some other method.</p> <p>For ZK Sync keys to be valid user should register them once in the ZK Sync network using <a href="#changing-account-public-key">set signing key transaction</a>. For
ethereum wallets that do not support message signing <a href="#authorize-new-public-key-using-ethereum-transaction">additional ethereum transaction</a> is required.
ZK Sync keys can be changed at any time.</p> <h3 id="creating-wallet-from-eth-signer"><a href="#creating-wallet-from-eth-signer" class="header-anchor">#</a> Creating wallet from ETH signer</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">fromEthSigner</span><span class="token punctuation">(</span>
    ethWallet<span class="token operator">:</span> ethers<span class="token punctuation">.</span>Signer<span class="token punctuation">,</span>
    provider<span class="token operator">:</span> Provider<span class="token punctuation">,</span>
    signer<span class="token operator">?</span><span class="token operator">:</span> Signer
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Wallet<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs"><a href="#inputs-and-outputs" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>ethWallet</td> <td><code>ethers.Signer</code> that corresponds to keys that own this account</td></tr> <tr><td>provider</td> <td>Sync provider that is used for submitting a transaction to the Sync network.</td></tr> <tr><td>signer (optional)</td> <td>Sync signer that will be used for transaction signing. If undefined <code>Signer</code> will be derived from ethereum signature of specific message.</td></tr> <tr><td>returns</td> <td><code>zksync.Wallet</code> derived from ethereum wallet (<code>ethers.Signer</code>)</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> zksync <span class="token keyword">from</span> <span class="token string">&quot;zksync&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ethersProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ethers<span class="token punctuation">.</span>getDefaultProvider</span><span class="token punctuation">(</span><span class="token string">'rinkeby'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> syncProvider <span class="token operator">=</span> <span class="token keyword">await</span> zksync<span class="token punctuation">.</span><span class="token function">getDefaultProvider</span><span class="token punctuation">(</span><span class="token string">'testnet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ethWallet <span class="token operator">=</span> ethers<span class="token punctuation">.</span>Wallet<span class="token punctuation">.</span><span class="token function">createRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>ethersProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> syncWallet <span class="token operator">=</span> <span class="token keyword">await</span> zksync<span class="token punctuation">.</span>Wallet<span class="token punctuation">.</span><span class="token function">fromEthSigner</span><span class="token punctuation">(</span>ethWallet<span class="token punctuation">,</span> syncProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="creating-wallet-from-eth-without-zksync-signer"><a href="#creating-wallet-from-eth-without-zksync-signer" class="header-anchor">#</a> Creating wallet from ETH without ZKSync signer</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">fromEthSignerNoKeys</span><span class="token punctuation">(</span>
    ethWallet<span class="token operator">:</span> ethers<span class="token punctuation">.</span>Signer<span class="token punctuation">,</span>
    provider<span class="token operator">:</span> Provider
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Wallet<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>This way wallet won't contain any valid ZKSync keys to perform transactions, but some of the operations can be used without it. (Deposit, Emergency exit, reading account state)</p> <h4 id="inputs-and-outputs-2"><a href="#inputs-and-outputs-2" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>ethWallet</td> <td><code>ethers.Signer</code> that corresponds to keys that own this account</td></tr> <tr><td>provider</td> <td>Sync provider that is used for submitting a transaction to the Sync network.</td></tr> <tr><td>returns</td> <td><code>zksync.Wallet</code> derived from ethereum wallet (<code>ethers.Signer</code>)</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> zksync <span class="token keyword">from</span> <span class="token string">&quot;zksync&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ethersProvider <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ethers<span class="token punctuation">.</span>getDefaultProvider</span><span class="token punctuation">(</span><span class="token string">'rinkeby'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> syncProvider <span class="token operator">=</span> <span class="token keyword">await</span> zksync<span class="token punctuation">.</span><span class="token function">getDefaultProvider</span><span class="token punctuation">(</span><span class="token string">'testnet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ethWallet <span class="token operator">=</span> ethers<span class="token punctuation">.</span>Wallet<span class="token punctuation">.</span><span class="token function">createRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span>ethersProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> syncWallet <span class="token operator">=</span> <span class="token keyword">await</span> zksync<span class="token punctuation">.</span>Wallet<span class="token punctuation">.</span><span class="token function">fromEthSignerNoKeys</span><span class="token punctuation">(</span>ethWallet<span class="token punctuation">,</span> syncProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="get-account-state"><a href="#get-account-state" class="header-anchor">#</a> Get account state</h3> <p>Same as <a href="#get-account-state-by-address">Get account state from provider</a> but gets state of this account.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">getAccountState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>AccountState<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-3"><a href="#inputs-and-outputs-3" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>returns</td> <td>State of the given account.</td></tr></tbody></table> <p>For convenience it is possible to obtain the account ID.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">getAccountId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>returns</td> <td>Numerical account ID in the the ZK Sync tree state. Returned <code>undefined</code> value means that the account does not exist in the state tree.</td></tr></tbody></table> <h3 id="get-token-balance-on-zk-sync"><a href="#get-token-balance-on-zk-sync" class="header-anchor">#</a> Get token balance on ZK Sync</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">getBalance</span><span class="token punctuation">(</span>
    token<span class="token operator">:</span> TokenLike<span class="token punctuation">,</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">&quot;committed&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;verified&quot;</span> <span class="token operator">=</span> <span class="token string">&quot;committed&quot;</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumber<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-4"><a href="#inputs-and-outputs-4" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>token</td> <td>token of interest, symbol or address of the supported token</td></tr> <tr><td>type</td> <td>&quot;committed&quot; or &quot;verified&quot;</td></tr> <tr><td>returns</td> <td>Balance of this token</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">// setup wallet</span>

<span class="token comment">// Get committed Ethereum balance.</span>
<span class="token keyword">const</span> ethCommittedBalance <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token string">&quot;ETH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get verified ERC20 token balance.</span>
<span class="token keyword">const</span> erc20VerifiedBalance <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getBalance</span><span class="token punctuation">(</span><span class="token string">&quot;0xFab46E002BbF0b4509813474841E0716E6730136&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;verified&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre></div><h3 id="get-token-balance-on-ethereum"><a href="#get-token-balance-on-ethereum" class="header-anchor">#</a> Get token balance on Ethereum</h3> <p>Method similar to <a href="#get-token-balance-on-zk-sync"><code>syncWallet.getBalance</code></a>, used to query balance in the Ethereum network.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">getEthereumBalance</span><span class="token punctuation">(</span>token<span class="token operator">:</span> TokenLike<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>utils<span class="token punctuation">.</span>BigNumber<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-5"><a href="#inputs-and-outputs-5" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>token</td> <td>token of interest, symbol or address of the supported token</td></tr> <tr><td>returns</td> <td>Balance of this token</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> zksync <span class="token keyword">from</span> <span class="token string">&quot;zksync&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Setup zksync.Wallet with ethers signer/wallet that is connected to ethers provider</span>
<span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span> 

<span class="token keyword">const</span> ethOnChainBalance <span class="token operator">=</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">getEthereumBalance</span><span class="token punctuation">(</span><span class="token string">&quot;ETH&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="unlocking-erc20-deposits"><a href="#unlocking-erc20-deposits" class="header-anchor">#</a> Unlocking ERC20 deposits</h3> <p>For convenience, it is possible to approve the maximum possible amount of ERC20 token deposits for the ZK Sync contract so that
user would not need to approve each deposit.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">approveERC20TokenDeposits</span><span class="token punctuation">(</span>
    token<span class="token operator">:</span> TokenLike
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ethers<span class="token punctuation">.</span>ContractTransaction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>deposit.token</td> <td>ERC20 token</td></tr> <tr><td>returns</td> <td>Handle for the ethereum transaction.</td></tr></tbody></table> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">isERC20DepositsApproved</span><span class="token punctuation">(</span>token<span class="token operator">:</span> TokenLike<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>deposit.token</td> <td>ERC20 token to be approved for deposits</td></tr> <tr><td>returns</td> <td>True if the token deposits are approved</td></tr></tbody></table> <h3 id="deposit-token-to-sync"><a href="#deposit-token-to-sync" class="header-anchor">#</a> Deposit token to Sync</h3> <p>Moves funds from the ethereum account to the Sync account.
Fees are paid by ethereum account in ETH currency. The fee should be &gt;=  base fee, calculated on the contract based on the current gas price.</p> <p>Formula for base fee calculation:</p> <table><thead><tr><th>Token</th> <th>Formula</th></tr></thead> <tbody><tr><td>ETH token</td> <td><code>2 * 179000 * GAS_PRICE</code></td></tr> <tr><td>ERC20 token</td> <td><code>2 * 214000 * GAS_PRICE</code></td></tr></tbody></table> <p>See <a href="#estimate-deposit-fee">utils for estimating fee</a>.</p> <p>For ETH token deposit <code>amount</code> of the ETH will be deposited to the ZK Sync network and on top of that, some fee will be spent according to the formula above.
In other words, user will spend (<code>amount</code> + <code>fee</code> + <code>gasFee for deposit transaction</code>) on the Ethereum network and receive (<code>amount</code>) on the ZK Sync account.</p> <p>For the ERC20 token transfer fees are paid in the ETH token. To do the ERC20 token transfer, this token transfer should be approved. User can make ERC20 deposits approved forever using
<a href="#unlocking-erc20-deposits">unlocking ERC20 token</a>, or the user can approve the exact amount (required for a deposit) upon each deposit, but this is not recommended.</p> <p>After the transaction is committed, funds are already usable by the recipient, so there is no need to wait for verification before proceeding
unless additional confirmation is required for your application.
To wait for the transaction commitment on the ZK Sync network, use <code>awaitReceipt</code>(see <a href="#awaiting-for-operation-completion">utils</a>).</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">depositToSyncFromEthereum</span><span class="token punctuation">(</span>deposit<span class="token operator">:</span> <span class="token punctuation">{</span>
    depositTo<span class="token operator">:</span> Address<span class="token punctuation">;</span>
    token<span class="token operator">:</span> TokenLike<span class="token punctuation">;</span>
    amount<span class="token operator">:</span> utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    maxFeeInETHToken<span class="token operator">?</span><span class="token operator">:</span> utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    approveDepositAmountForERC20<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ETHOperation<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-6"><a href="#inputs-and-outputs-6" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>deposit.depositTo</td> <td>Sync account address of the receiver</td></tr> <tr><td>deposit.token</td> <td>token to be transferred (symbol or address of the supported token)</td></tr> <tr><td>deposit.amount</td> <td>amount of token to be transferred</td></tr> <tr><td>deposit.maxFeeInETHToken</td> <td>amount of <code>ETH</code> to be paid by <code>depositFrom</code> wallet as a fee for this transaction. <br>If undefined, 115% of the base fee will be assumed with current <code>GAS_PRICE</code> in the formula.</td></tr> <tr><td>deposit.approveDepositAmountForERC20(optional)</td> <td>If set, the user will be asked to approve the ERC20 token spending to our account (not required if <a href="#unlocking-erc20-deposits">token was unlocked</a>)</td></tr> <tr><td>returns</td> <td>Handle for this transaction.</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> zksync <span class="token keyword">from</span> <span class="token string">&quot;zksync&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> syncWallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span> <span class="token comment">// Setup zksync wallet from ethers.Signer.</span>

<span class="token keyword">const</span> depositPriorityOperation <span class="token operator">=</span> <span class="token keyword">await</span> syncWallet<span class="token punctuation">.</span><span class="token function">depositToSyncFromEthereum</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    depositTo<span class="token operator">:</span> <span class="token string">&quot;0x2d5bf7a3ab29f0ff424d738a83f9b0588bc9241e&quot;</span><span class="token punctuation">,</span>
    token<span class="token operator">:</span> <span class="token string">&quot;ETH&quot;</span><span class="token punctuation">,</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">formatEther</span><span class="token punctuation">(</span><span class="token string">&quot;1.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    maxFeeInETHToken<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">formatEther</span><span class="token punctuation">(</span><span class="token string">&quot;0.1&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Wait till priority operation is committed.</span>
<span class="token keyword">const</span> priorityOpReceipt <span class="token operator">=</span> <span class="token keyword">await</span> depositPriorityOperation<span class="token punctuation">.</span><span class="token function">awaitReceipt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="changing-account-public-key"><a href="#changing-account-public-key" class="header-anchor">#</a> Changing account public key</h3> <p>In order to send ZKSync transactions (transfer and withdraw) user has to associate zksync key pair with account. Every ZKSync account has address which is
ethereum address of the owner.</p> <p>There are two ways to authorize zksync key pair.</p> <ol><li>Using ethereum signature of specific message.
This way is prefered but can only be used if your ethereum wallet can sign messages.</li> <li>Using ethereum transaction to ZKSync smart-contract.</li></ol> <aside class="notice">
The account should be present in the ZK Sync network in order to set a signing key for it. 
</aside> <p>This function will throw an error if the account is not present in the ZK Sync network.
Check the <a href="#get-account-state">account id</a> to see if account is present in the ZK Sync state tree.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">setSigningKey</span><span class="token punctuation">(</span>
    nonce<span class="token operator">:</span> Nonce <span class="token operator">=</span> <span class="token string">&quot;committed&quot;</span><span class="token punctuation">,</span>
    onchainAuth <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Transaction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-7"><a href="#inputs-and-outputs-7" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>nonce</td> <td>Nonce that is going to be used for this transaction. (&quot;committed&quot; is used for the last known nonce for this account)</td></tr> <tr><td>onchainAuth</td> <td>When false <code>ethers.Signer</code> is used to create signature, otherwise it is expected that user called <code>onchainAuthSigningKey</code> to authorize new pubkey.</td></tr> <tr><td>returns</td> <td>Handle of the submitted transaction</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">// setup zksync wallet</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">isSigningKeySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> changePubkey<span class="token operator">=</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Wait till transaction is committed</span>
    <span class="token keyword">const</span> receipt <span class="token operator">=</span> <span class="token keyword">await</span> changePubkey<span class="token punctuation">.</span><span class="token function">awaitReceipt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="authorize-new-public-key-using-ethereum-transaction"><a href="#authorize-new-public-key-using-ethereum-transaction" class="header-anchor">#</a> Authorize new public key using ethereum transaction</h3> <p>This method is used to authorize <a href="#changing-account-public-key">public key change</a> using ethereum transaction for
wallets that don't support message signing.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">onchainAuthSigningKey</span><span class="token punctuation">(</span>
    nonce<span class="token operator">:</span> Nonce <span class="token operator">=</span> <span class="token string">&quot;committed&quot;</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ContractTransaction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-8"><a href="#inputs-and-outputs-8" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>nonce</td> <td>Nonce that is going to be used for <code>setSigningKey</code> transaction. (&quot;committed&quot; is used for the last known nonce for this account)</td></tr> <tr><td>returns</td> <td>Handle of the submitted transaction</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">// setup zksync wallet</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">isSigningKeySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> onchainAuthTransaction <span class="token operator">=</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">onchainAuthSigningKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Wait till transaction is committed on ethereum.</span>
    <span class="token keyword">await</span> onchainAuthTransaction<span class="token punctuation">.</span><span class="token function">wait</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> changePubkey<span class="token operator">=</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token string">&quot;committed&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Wait till transaction is committed</span>
    <span class="token keyword">const</span> receipt <span class="token operator">=</span> <span class="token keyword">await</span> changePubkey<span class="token punctuation">.</span><span class="token function">awaitReceipt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="check-if-current-public-key-is-set"><a href="#check-if-current-public-key-is-set" class="header-anchor">#</a> Check if current public key is set</h3> <p>Checks if current signer that is associated with wallet is able to sign transactions.
See <a href="#changing-account-public-key">change pub key</a> on how to change current public key.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">isSigningKeySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-9"><a href="#inputs-and-outputs-9" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>returns</td> <td>True if current signer that is assigned to wallet can sign transactions.</td></tr></tbody></table> <h3 id="transfer-in-the-zk-sync"><a href="#transfer-in-the-zk-sync" class="header-anchor">#</a> Transfer in the ZK Sync</h3> <p>Moves funds between accounts inside the ZK Sync network.
Sender account should have correct public key set before sending this transaction. (see <a href="#changing-account-public-key">change pub key</a>)</p> <p>Before sending this transaction, the user will be asked to sign a specific message with transaction details using their Ethereum account (because of the security reasons).</p> <p>After the transaction is committed, funds are already usable by the recipient, so there is no need to wait for verification before proceeding
unless additional confirmation is required for your application.
To wait for transaction commit use <code>awaitReceipt</code>(see <a href="#awaiting-for-operation-completion">utils</a>).</p> <aside class="notice">
The transfer amount and fee should have a limited number of significant digits according to spec.
See utils for helping with amounts packing.
</aside> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">syncTransfer</span><span class="token punctuation">(</span>transfer<span class="token operator">:</span> <span class="token punctuation">{</span>
    to<span class="token operator">:</span> Address<span class="token punctuation">,</span>
    token<span class="token operator">:</span> Token<span class="token punctuation">,</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">,</span>
    fee<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">,</span>
    nonce<span class="token operator">?</span><span class="token operator">:</span> Nonce
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Transaction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-10"><a href="#inputs-and-outputs-10" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>transfer.to</td> <td>Sync address of the recipient of funds</td></tr> <tr><td>transfer.token</td> <td>token to be transferred (symbol or address of the token)</td></tr> <tr><td>transfer.amount</td> <td>amount of token to be transferred. To see if amount is packable use <a href="#closest-packable-amount">pack amount util</a></td></tr> <tr><td>transfer.fee</td> <td>amount of token to be paid as a fee for this transaction. To see if amount is packable use <a href="#closest-packable-fee">pack fee util</a></td></tr> <tr><td>transfer.nonce</td> <td>Nonce that is going to be used for this transaction. (&quot;committed&quot; is used for the last known nonce for this account)</td></tr> <tr><td>returns</td> <td>Handle of the submitted transaction</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">// setup zksync wallet</span>

<span class="token keyword">const</span> transferTransaction <span class="token operator">=</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">syncTransfer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    to<span class="token operator">:</span> <span class="token string">&quot;0x2d5bf7a3ab29f0ff424d738a83f9b0588bc9241e&quot;</span><span class="token punctuation">,</span>
    token<span class="token operator">:</span> <span class="token string">&quot;0xFab46E002BbF0b4509813474841E0716E6730136&quot;</span><span class="token punctuation">,</span> <span class="token comment">// FAU ERC20 token address</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">parseEther</span><span class="token punctuation">(</span><span class="token string">&quot;1.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    fee<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">parseEther</span><span class="token punctuation">(</span><span class="token string">&quot;0.001&quot;</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Wait till transaction is committed</span>
<span class="token keyword">const</span> transactionReceipt <span class="token operator">=</span> <span class="token keyword">await</span> transferTransaction<span class="token punctuation">.</span><span class="token function">awaitReceipt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="withdraw-token-from-sync"><a href="#withdraw-token-from-sync" class="header-anchor">#</a> Withdraw token from Sync</h3> <p>Moves funds from the Sync account to ethereum address.
Sender account should have correct public key set before sending this transaction. (see <a href="#changing-account-public-key">change pub key</a>)</p> <p>Before sending this transaction, the user will be asked to sign a specific message with transaction details using their Ethereum account (because of the security reasons).</p> <p>The transaction has to be verified until funds are available on the ethereum wallet balance so it is useful
to use <code>awaitVerifyReceipt</code>(see <a href="#awaiting-for-operation-completion">utils</a>) before checking ethereum balance.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">withdrawFromSyncToEthereum</span><span class="token punctuation">(</span>withdraw<span class="token operator">:</span> <span class="token punctuation">{</span>
    ethAddress<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    token<span class="token operator">:</span> Token<span class="token punctuation">,</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">,</span>
    fee<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">,</span>
    nonce<span class="token operator">?</span><span class="token operator">:</span> Nonce
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Transaction<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-11"><a href="#inputs-and-outputs-11" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>withdraw.ethAddress</td> <td>ethereum address of the recipient</td></tr> <tr><td>withdraw.token</td> <td>token to be transferred (&quot;ETH&quot; or address of the ERC20 token)</td></tr> <tr><td>withdraw.amount</td> <td>amount of token to be transferred</td></tr> <tr><td>withdraw.fee</td> <td>amount of token to be paid as a fee for this transaction. To see if amount is packable use <a href="#closest-packable-fee">pack fee util</a></td></tr> <tr><td>withdraw.nonce</td> <td>Nonce that is going to be used for this transaction. (&quot;committed&quot; is used for the last known nonce for this account)</td></tr> <tr><td>returns</td> <td>Handle of the submitted transaction</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> wallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span><span class="token comment">// setup zksync wallet</span>

<span class="token keyword">const</span> withdrawTransaction <span class="token operator">=</span> <span class="token keyword">await</span> wallet<span class="token punctuation">.</span><span class="token function">withdrawFromSyncToEthereum</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    ethAddress<span class="token operator">:</span> <span class="token string">&quot;0x9de880ac69f3ed1e4d6870fcdabf07cbbed6f85c&quot;</span><span class="token punctuation">,</span>
    token<span class="token operator">:</span> <span class="token string">&quot;FAU&quot;</span><span class="token punctuation">,</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">parseEther</span><span class="token punctuation">(</span><span class="token string">&quot;1.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
    fee<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">parseEther</span><span class="token punctuation">(</span><span class="token string">&quot;0.001&quot;</span><span class="token punctuation">)</span> 
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Wait wait till transaction is verified</span>
<span class="token keyword">const</span> transactionReceipt <span class="token operator">=</span> <span class="token keyword">await</span> withdrawTransaction<span class="token punctuation">.</span><span class="token function">awaitVerifyReceipt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="emergency-withdraw-from-sync"><a href="#emergency-withdraw-from-sync" class="header-anchor">#</a> Emergency withdraw from Sync</h3> <p>If ordinary withdraw from Sync account is ignored by network operators user could create an emergency
withdraw request using special ethereum transaction, this withdraw request can't be ignored.</p> <p>Moves the full amount of the given token from the Sync account to the ethereum account(represented as <code>Signer</code> from <code>ethers.js</code>).</p> <p>Fees are paid by ethereum account in ETH currency. The fee should be &gt;=  base fee, calculated on the contract based on the current gas price.
The formula for base fee calculation: <code>2 * 170000 * GAS_PRICE</code></p> <p>See <a href="#estimate-emergency-withdraw-fee">utils for estimating fee</a>.</p> <p>The transaction has to be verified until funds are available on the ethereum wallet balance so it is useful
to use <code>awaitVerifyReceipt</code>(see <a href="#awaiting-for-operation-completion">utils</a>) before checking ethereum balance.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">emergencyWithdraw</span><span class="token punctuation">(</span>withdraw<span class="token operator">:</span> <span class="token punctuation">{</span>
    token<span class="token operator">:</span> TokenLike<span class="token punctuation">;</span>
    maxFeeInETHToken<span class="token operator">?</span><span class="token operator">:</span> utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    accountId<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    nonce<span class="token operator">?</span><span class="token operator">:</span> Nonce<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ETHOperation<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-12"><a href="#inputs-and-outputs-12" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>withdraw.token</td> <td>token to be withdrawn (symbol or address of the supported token)</td></tr> <tr><td>withdraw.amount</td> <td>amount of token to be transferred</td></tr> <tr><td>withdraw.maxFeeInETHToken</td> <td>amount of <code>ETH</code> to be paid by <code>withdrawTo</code> wallet as a fee for this transaction. <br>If undefined, 115% of the base fee will be assumed with current <code>GAS_PRICE</code> in the formula.</td></tr> <tr><td>withdraw.accountId</td> <td>Numerical id of the given account. If undefined it is going to be resolved from the ZK Sync provider.</td></tr> <tr><td>withdraw.nonce</td> <td>Transaction nonce. &quot;committed&quot; by default</td></tr> <tr><td>returns</td> <td>Handle for this transaction.</td></tr></tbody></table> <blockquote><p>Example</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> zksync <span class="token keyword">from</span> <span class="token string">&quot;zksync&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>ethers<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;ethers&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> syncWallet <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span> <span class="token comment">// Setup zksync wallet.</span>

<span class="token keyword">const</span> emergencyWithdrawPriorityOp <span class="token operator">=</span> <span class="token keyword">await</span> syncWallet<span class="token punctuation">.</span><span class="token function">emergencyWithdraw</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    token<span class="token operator">:</span> <span class="token string">&quot;ETH&quot;</span><span class="token punctuation">,</span>
    maxFeeInETHToken<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">parseEther</span><span class="token punctuation">(</span><span class="token string">&quot;0.3&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Wait till priority operation is verified.</span>
<span class="token keyword">const</span> priorityOpReceipt <span class="token operator">=</span> <span class="token keyword">await</span> emergencyWithdrawPriorityOp<span class="token punctuation">.</span><span class="token function">awaitVerifyReceipt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="signer"><a href="#signer" class="header-anchor">#</a> Signer</h2> <h3 id="create-from-private-key"><a href="#create-from-private-key" class="header-anchor">#</a> Create from private key</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">static</span> <span class="token function">fromPrivateKey</span><span class="token punctuation">(</span>pk<span class="token operator">:</span> <span class="token constant">BN</span><span class="token punctuation">)</span><span class="token operator">:</span> Signer<span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-13"><a href="#inputs-and-outputs-13" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>pk</td> <td>private key</td></tr> <tr><td>returns</td> <td><code>Signer</code> derived from private key</td></tr></tbody></table> <h3 id="create-from-seed"><a href="#create-from-seed" class="header-anchor">#</a> Create from seed</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">static</span> <span class="token function">fromSeed</span><span class="token punctuation">(</span>seed<span class="token operator">:</span> Buffer<span class="token punctuation">)</span><span class="token operator">:</span> Signer<span class="token punctuation">;</span>
</code></pre></div><h3 id="create-from-ethereum-signature"><a href="#create-from-ethereum-signature" class="header-anchor">#</a> Create from ethereum signature</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">static</span> <span class="token keyword">async</span> <span class="token function">fromETHSignature</span><span class="token punctuation">(</span>ethSigner<span class="token operator">:</span> ethers<span class="token punctuation">.</span>Signer<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Signer<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-14"><a href="#inputs-and-outputs-14" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>ethSigner</td> <td>Ethereum signer that is going to be used for signature generation.</td></tr> <tr><td>returns</td> <td><code>Signer</code> derived from this seed</td></tr></tbody></table> <h3 id="get-public-key-hash"><a href="#get-public-key-hash" class="header-anchor">#</a> Get public key hash</h3> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">pubKeyHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> PubKeyHash<span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-15"><a href="#inputs-and-outputs-15" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>returns</td> <td>Pubkey hash derived from corresponding public key. (<code>sync:</code> prefixed hex-encoded)</td></tr></tbody></table> <h3 id="sign-sync-transfer"><a href="#sign-sync-transfer" class="header-anchor">#</a> Sign sync transfer</h3> <p>Signs transfer transaction, the result can be submitted to the Sync network.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">signSyncTransfer</span><span class="token punctuation">(</span>transfer<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token operator">:</span> Address<span class="token punctuation">;</span>
    to<span class="token operator">:</span> Address<span class="token punctuation">;</span>
    tokenId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    fee<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    nonce<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> SyncTransfer<span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-16"><a href="#inputs-and-outputs-16" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>transfer.from</td> <td>Address of the sender</td></tr> <tr><td>transfer.to</td> <td>Address of the recipient</td></tr> <tr><td>transfer.tokenId</td> <td>Numerical token id</td></tr> <tr><td>transfer.amount</td> <td>Amount to transfer, payed in token</td></tr> <tr><td>transfer.fee</td> <td>Fee to pay for transfer, payed in token</td></tr> <tr><td>transfer.nonce</td> <td>Transaction nonce</td></tr> <tr><td>returns</td> <td>Signed Sync transfer transaction</td></tr></tbody></table> <h3 id="sign-sync-withdraw"><a href="#sign-sync-withdraw" class="header-anchor">#</a> Sign Sync Withdraw</h3> <p>Signs withdraw transaction, the result can be submitted to the Sync network.</p> <blockquote><p>Signature</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">signSyncWithdraw</span><span class="token punctuation">(</span>withdraw<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token keyword">from</span><span class="token operator">:</span> Address<span class="token punctuation">;</span>
    ethAddress<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    tokenId<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    amount<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    fee<span class="token operator">:</span> ethers<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>BigNumberish<span class="token punctuation">;</span>
    nonce<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> SyncWithdraw<span class="token punctuation">;</span>
</code></pre></div><h4 id="inputs-and-outputs-17"><a href="#inputs-and-outputs-17" class="header-anchor">#</a> Inputs and outputs</h4> <table><thead><tr><th>Name</th> <th>Description</th></tr></thead> <tbody><tr><td>withdraw.from</td> <td>Account address of the sender</td></tr> <tr><td>withdraw.ethAddress</td> <td>Ethereum address of the recipient</td></tr> <tr><td>withdraw.tokenId</td> <td>Numerical token id</td></tr> <tr><td>withdraw.amount</td> <td>Amount to withdraw, paid in token</td></tr> <tr><td>withdraw.fee</td> <td>Fee to pay for withdrawing, paid in token</td></tr> <tr><td>withdraw.nonce</td> <td>Transaction nonce</td></tr> <tr><td>returns</td> <td>Signed Sync withdraw transaction</td></tr></tbody></table></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/3/2020, 10:10:55 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/providers.html" class="prev">
        Providers
      </a></span> <span class="next"><a href="/utils.html">
        Utils
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b82d5895.js" defer></script><script src="/assets/js/2.565b9e27.js" defer></script><script src="/assets/js/6.6f653a50.js" defer></script>
  </body>
</html>
